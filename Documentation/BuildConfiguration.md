# Build Configuration

## Overview

This document describes the build configuration files for the AI27 Simulator project, an Unreal Engine 5.5 C++ project.

## File Structure

```
Source/
├── ai27Simulator.Target.cs          # Game target rules
├── ai27SimulatorEditor.Target.cs    # Editor target rules
└── ai27Simulator/
    ├── ai27Simulator.Build.cs       # Module build rules
    ├── ai27Simulator.h              # Module header
    └── ai27Simulator.cpp            # Module implementation
```

## Target Files

### ai27Simulator.Target.cs

**Purpose:** Defines build rules for the standalone game executable.

**File Location:** `Source/ai27Simulator.Target.cs`

```csharp
using UnrealBuildTool;
using System.Collections.Generic;

public class ai27SimulatorTarget : TargetRules
{
    public ai27SimulatorTarget(TargetInfo Target) : base(Target)
    {
        Type = TargetType.Game;
        DefaultBuildSettings = BuildSettingsVersion.V5;
        IncludeOrderVersion = EngineIncludeOrderVersion.Unreal5_5;
        ExtraModuleNames.Add("ai27Simulator");
    }
}
```

**Key Settings:**
| Setting | Value | Description |
|---------|-------|-------------|
| `Type` | `TargetType.Game` | Builds as standalone game |
| `DefaultBuildSettings` | `BuildSettingsVersion.V5` | Uses UE5 build settings |
| `IncludeOrderVersion` | `Unreal5_5` | Header include order for UE 5.5 |
| `ExtraModuleNames` | `ai27Simulator` | Primary game module |

### ai27SimulatorEditor.Target.cs

**Purpose:** Defines build rules for the editor version (development).

**File Location:** `Source/ai27SimulatorEditor.Target.cs`

```csharp
using UnrealBuildTool;
using System.Collections.Generic;

public class ai27SimulatorEditorTarget : TargetRules
{
    public ai27SimulatorEditorTarget(TargetInfo Target) : base(Target)
    {
        Type = TargetType.Editor;
        DefaultBuildSettings = BuildSettingsVersion.V5;
        IncludeOrderVersion = EngineIncludeOrderVersion.Unreal5_5;
        ExtraModuleNames.Add("ai27Simulator");
    }
}
```

**Key Settings:**
| Setting | Value | Description |
|---------|-------|-------------|
| `Type` | `TargetType.Editor` | Builds for Unreal Editor |

## Module Configuration

### ai27Simulator.Build.cs

**Purpose:** Defines module dependencies and build configuration.

**File Location:** `Source/ai27Simulator/ai27Simulator.Build.cs`

```csharp
using UnrealBuildTool;

public class ai27Simulator : ModuleRules
{
    public ai27Simulator(ReadOnlyTargetRules Target) : base(Target)
    {
        PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;

        PublicDependencyModuleNames.AddRange(new string[] {
            "Core",
            "CoreUObject",
            "Engine",
            "InputCore",
            "EnhancedInput"
        });

        PrivateDependencyModuleNames.AddRange(new string[] { });
    }
}
```

**PCH Usage:**
- `UseExplicitOrSharedPCHs`: Uses precompiled headers for faster compilation

**Public Dependencies:**

| Module | Purpose |
|--------|---------|
| `Core` | Core Unreal functionality |
| `CoreUObject` | UObject system |
| `Engine` | Engine classes (AActor, UActorComponent, etc.) |
| `InputCore` | Input system basics |
| `EnhancedInput` | New input system for UE5 |

**Private Dependencies:**
- Currently none
- Add Slate/SlateCore for UI
- Add OnlineSubsystem for networking

### ai27Simulator.h

**Purpose:** Module header file with core includes.

**File Location:** `Source/ai27Simulator/ai27Simulator.h`

```cpp
#pragma once

#include "CoreMinimal.h"
```

This minimal header includes `CoreMinimal.h` which provides the most commonly used engine types and macros.

### ai27Simulator.cpp

**Purpose:** Module implementation and registration.

**File Location:** `Source/ai27Simulator/ai27Simulator.cpp`

```cpp
#include "ai27Simulator.h"
#include "Modules/ModuleManager.h"

IMPLEMENT_PRIMARY_GAME_MODULE(FDefaultGameModuleImpl, ai27Simulator, "ai27Simulator");
```

**Macro Breakdown:**
- `IMPLEMENT_PRIMARY_GAME_MODULE`: Registers this as the primary game module
- `FDefaultGameModuleImpl`: Uses default module implementation
- `ai27Simulator`: Module name (must match .Build.cs class name)
- `"ai27Simulator"`: String identifier for the module

## API Export Macro

The project defines `AI27SIMULATOR_API` macro for DLL export:

```cpp
class AI27SIMULATOR_API USplineMovementComponent : public UActorComponent
class AI27SIMULATOR_API ARoadSplineActor : public AActor
class AI27SIMULATOR_API ARoadIntersection : public AActor
class AI27SIMULATOR_API ATestVehicle : public APawn
```

This macro is automatically generated by Unreal Build Tool and ensures proper symbol export when building as DLL.

## Engine Version

- **Unreal Engine:** 5.5
- **Build Settings Version:** V5
- **Include Order:** Unreal5_5

## Building the Project

### From Editor

1. Open the project in Unreal Editor
2. File -> Package Project -> Windows/Mac/Linux

### From Command Line

```bash
# Build Game
UnrealBuildTool.exe ai27Simulator Win64 Development -Project="path/to/ai27Simulator.uproject"

# Build Editor
UnrealBuildTool.exe ai27SimulatorEditor Win64 Development -Project="path/to/ai27Simulator.uproject"
```

### Using RunUAT

```bash
RunUAT.bat BuildCookRun -project="path/to/ai27Simulator.uproject" -platform=Win64 -configuration=Development -build -cook -stage
```

## Adding New Dependencies

### Public Dependency

Add to `PublicDependencyModuleNames` when:
- Headers are included in your public headers
- Types are exposed in public class interfaces

```csharp
PublicDependencyModuleNames.AddRange(new string[] {
    "Core",
    "CoreUObject",
    "Engine",
    "InputCore",
    "EnhancedInput",
    "AIModule"  // Example: Adding AI module
});
```

### Private Dependency

Add to `PrivateDependencyModuleNames` when:
- Module is only used in .cpp implementation files
- Types are not exposed publicly

```csharp
PrivateDependencyModuleNames.AddRange(new string[] {
    "Slate",
    "SlateCore"  // Example: UI only used internally
});
```

## Common Module Additions

### For UI Development

```csharp
PrivateDependencyModuleNames.AddRange(new string[] {
    "Slate",
    "SlateCore",
    "UMG"
});
```

### For Networking

```csharp
PrivateDependencyModuleNames.Add("OnlineSubsystem");
// Also add to .uproject plugins:
// "OnlineSubsystemSteam" with Enabled=true
```

### For AI

```csharp
PublicDependencyModuleNames.AddRange(new string[] {
    "AIModule",
    "NavigationSystem"
});
```

### For Physics

```csharp
PublicDependencyModuleNames.AddRange(new string[] {
    "PhysicsCore",
    "Chaos"
});
```

## Folder Structure Conventions

```
Source/ai27Simulator/
├── Public/              # Headers (.h)
│   ├── Components/      # ActorComponents
│   ├── RoadSystem/      # Road-related actors
│   └── Vehicles/        # Vehicle pawns
├── Private/             # Implementations (.cpp)
│   ├── Components/
│   ├── RoadSystem/
│   └── Vehicles/
├── ai27Simulator.h      # Module header
├── ai27Simulator.cpp    # Module implementation
└── ai27Simulator.Build.cs
```

## Generated Files

The build process generates:
- `Intermediate/`: Build intermediates
- `Binaries/`: Compiled binaries
- `.generated.h`: UCLASS/USTRUCT generated headers

---

*Copyright 2025 AI27. All Rights Reserved.*
*Designer: Aldo Maradon Duran Bautista*
